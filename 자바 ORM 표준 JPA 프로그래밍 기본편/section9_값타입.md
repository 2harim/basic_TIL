**ëª©ì°¨**
- [âœ”ï¸ **JPAì˜ ë°ì´í„° íƒ€ì… ë¶„ë¥˜**](#ï¸-jpaì˜-ë°ì´í„°-íƒ€ì…-ë¶„ë¥˜)
- [ğŸ°Â ê¸°ë³¸ê°’ íƒ€ì…](#ê¸°ë³¸ê°’-íƒ€ì…)
- [ğŸ‚Â ì„ë² ë””ë“œ íƒ€ì… (ë³µí•©ê°’ íƒ€ì…)](#ì„ë² ë””ë“œ-íƒ€ì…-ë³µí•©ê°’-íƒ€ì…)
  - [ì˜ˆì œ](#ì˜ˆì œ)
  - [ì‚¬ìš©ë²•](#ì‚¬ìš©ë²•)
  - [ì¥ì ](#ì¥ì )
  - [í…Œì´ë¸” ë§¤í•‘](#í…Œì´ë¸”-ë§¤í•‘)
  - [ì„ë² ë””ë“œ íƒ€ì…ê³¼ ì—°ê´€ê´€ê³„](#ì„ë² ë””ë“œ-íƒ€ì…ê³¼-ì—°ê´€ê´€ê³„)
- [ğŸš«Â ê°’ íƒ€ì…ê³¼ ë¶ˆë³€ ê°ì²´](#ê°’-íƒ€ì…ê³¼-ë¶ˆë³€-ê°ì²´)
  - [ê°’ íƒ€ì… ê³µìœ  ì°¸ì¡°](#ê°’-íƒ€ì…-ê³µìœ -ì°¸ì¡°)
  - [ê°ì²´ íƒ€ì…ì˜ í•œê³„](#ê°ì²´-íƒ€ì…ì˜-í•œê³„)
  - [ë¶ˆë³€ ê°ì²´](#ë¶ˆë³€-ê°ì²´)
- [âš–ï¸Â ê°’ íƒ€ì…ì˜ ë¹„êµ](#ï¸ê°’-íƒ€ì…ì˜-ë¹„êµ)
- [ğŸ—Â ê°’ íƒ€ì… ì»¬ë ‰ì…˜](#ê°’-íƒ€ì…-ì»¬ë ‰ì…˜)
  - [ê°’ íƒ€ì… ì»¬ë ‰ì…˜ ì‚¬ìš©](#ê°’-íƒ€ì…-ì»¬ë ‰ì…˜-ì‚¬ìš©)
  - [ê°’ íƒ€ì… ì»¬ë ‰ì…˜ ì œì•½ì‚¬í•­](#ê°’-íƒ€ì…-ì»¬ë ‰ì…˜-ì œì•½ì‚¬í•­)
- [ğŸŒ´Â ì‹¤ì „ ì˜ˆì œ 6 - ê°’ íƒ€ì… ë§¤í•‘](#ì‹¤ì „-ì˜ˆì œ-6---ê°’-íƒ€ì…-ë§¤í•‘)

<br>

## âœ”ï¸ **JPAì˜ ë°ì´í„° íƒ€ì… ë¶„ë¥˜**

- **ì—”í‹°í‹° íƒ€ì…**
    - @Entity ì •ì˜í•˜ëŠ” ê°ì²´
    - ë°ì´í„° ë³€í•´ë„ ì‹ë³„ìë¡œ ì§€ì† ì¶”ì  ê°€ëŠ¥ â†’ íšŒì› ì—”í‹°í‹°ì˜ ì†ì„±ì„ ë³€ê²½í•´ë„ ì‹ë³„ìë¡œ ì¸ì‹ ê°€ëŠ¥
- **ê°’ íƒ€ì…**
    - int, Integer, String ì²˜ëŸ¼ ë‹¨ìˆœíˆ ê°’ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ìë°” ê¸°ë³¸ íƒ€ì…ì´ë‚˜ ê°ì²´
    - ì‹ë³„ì ì—†ê³  ê°’ë§Œ ìˆìŒ â†’ ë³€ê²½ ì‹œ ì¶”ì  ë¶ˆê°€
    - ë¶„ë¥˜
        - ê¸°ë³¸ê°’ íƒ€ì… : ìë°” ì›ì‹œ íƒ€ì…, ë˜í¼ í´ë˜ìŠ¤, String
        - ì„ë² ë””ë“œ íƒ€ì…
        - ì»¬ë ‰ì…˜ ê°’ íƒ€ì…

<br>

## ğŸ°Â ê¸°ë³¸ê°’ íƒ€ì…

- ìƒëª…ì£¼ê¸°ë¥¼ ì—”í‹°í‹°ì— ì˜ì¡´
    
    ex) íšŒì› ì‚­ì œí•˜ë©´ ë‚˜ë¨¸ì§€ í•„ë“œ í•¨ê»˜ ì‚­ì œë¨
    
- ê°’ íƒ€ì… ê³µìœ  X
    
    ex) íšŒì› ì´ë¦„ ë³€ê²½ ì‹œ ë‹¤ë¥¸ íšŒì› ì´ë¦„ë„ í•¨ê»˜ ë³€ê²½ë˜ë©´ X
    

> *ì›ì‹œ íƒ€ì…ì€ ì ˆëŒ€ ê³µìœ  X â†’ í•­ìƒ ê°’ì„ ë³µì‚¬í•¨!*
> 
> 
> *ë˜í¼ í´ë˜ìŠ¤ë‚˜ String ê°™ì€ íŠ¹ìˆ˜ í´ë˜ìŠ¤ëŠ” ê³µìœ  ê°€ëŠ¥í•œ ê°ì²´ì´ì§€ë§Œ ë³€ê²½ X*
> 

<br>

## ğŸ‚Â ì„ë² ë””ë“œ íƒ€ì… (ë³µí•©ê°’ íƒ€ì…)

- ìƒˆë¡œìš´ ê°’ íƒ€ì… ì§ì ‘ ì •ì˜ ê°€ëŠ¥
- ì£¼ë¡œ ê¸°ë³¸ê°’ íƒ€ì… ëª¨ì•„ì„œ ë§Œë“¤ì–´ì„œ ë³µí•©ê°’ íƒ€ì…ì´ë¼ê³ ë„ í•¨
- int, String ì²˜ëŸ¼ `ê°’ íƒ€ì…` ì„!

<br>

### ì˜ˆì œ

íšŒì› ì—”í‹°í‹°ëŠ” `ì´ë¦„, ê·¼ë¬´ ì‹œì‘ì¼, ê·¼ë¬´ ì¢…ë£Œì¼, ì£¼ì†Œ ë„ì‹œ, ì£¼ì†Œ ë²ˆì§€, ì£¼ì†Œ ìš°í¸ë²ˆí˜¸` ê°€ì§

â†’ ê³µí†µ ì†ì„±ë“¤ ë³´ì„

â‡’ íšŒì› ì—”í‹°í‹°ëŠ” `ì´ë¦„, ê·¼ë¬´ê¸°ê°„, ì§‘ ì£¼ì†Œ` ê°€ì§

![Untitled](/img/jpa_basic/section9/value_type.png)

<br>

### ì‚¬ìš©ë²•

`@Embeddable` : ê°’ íƒ€ì… ì •ì˜í•˜ëŠ” ê³³ì— 

`@Embedded` : ê°’ íƒ€ì… ì‚¬ìš©í•˜ëŠ” ê³³ì—

ê¸°ë³¸ìƒì„±ì í•„ìˆ˜

<br>

### ì¥ì 

- ì¬ì‚¬ìš©ì„±
- ë†’ì€ ì‘ì§‘ë„ â†’ í•´ë‹¹ ê°’ íƒ€ì…ë§Œ ì‚¬ìš©í•˜ëŠ” ì˜ë¯¸ìˆëŠ” ë©”ì„œë“œ ë§Œë“¤ ìˆ˜ ìˆìŒ
- ì„ë² ë””ë“œ íƒ€ì… í¬í•¨í•œ ëª¨ë“  ê°’ íƒ€ì…ì€ ê°’ íƒ€ì…ì„ ì†Œìœ í•œ ì—”í‹°í‹°ì— ìƒëª…ì£¼ê¸° ì˜ì¡´

<br>

### í…Œì´ë¸” ë§¤í•‘

![Untitled](/img/jpa_basic/section9/value_type_table.png)

```java
Member member = new Member();
member.setUsername("name");
member.setHomeAddress(new Address("city", "street", "10000"));
member.setWorkPeriod(new Period());
em.persist(member);
```

```sql
/* insert hellojpa.Member
    */ insert 
    into
        Member
        (city, street, zipcode, USERNAME, endDate, startDate, MEMBER_ID) 
    values
        (?, ?, ?, ?, ?, ?, ?)
```

ì„ë² ë””ë“œ íƒ€ì…ì€ ì—”í‹°í‹° ê°’ì¼ ë¿ â†’ ë§¤í•‘ í…Œì´ë¸” ë³€í™” X

ê°ì²´ì™€ í…Œì´ë¸”ì„ ì•„ì£¼ ì„¸ë°€í•˜ê²Œ ë§¤í•‘í•˜ëŠ” ê²ƒì´ ê°€ëŠ¥ â‡’ ì„ë² ë””ë“œ íƒ€ì…ë§Œì˜ ë©”ì„œë“œ ì‚¬ìš© ê°€ëŠ¥, ëª¨ë¸ë§ ê¹”ë”

ì„ë² ë””ë“œ íƒ€ì… ìì²´ê°€ nullì´ë©´ ë§¤í•‘í•œ ì»¬ëŸ¼ ëª¨ë‘ null

<br>

### ì„ë² ë””ë“œ íƒ€ì…ê³¼ ì—°ê´€ê´€ê³„

ì„ë² ë””ë“œ íƒ€ì…ì´ ì—”í‹°í‹° ê°ì²´ë¥¼ ê°€ì§€ê³  ìˆì„ ìˆ˜ ìˆìŒ

`@AttributeOverride` ì†ì„± ì¬ì •ì˜ â†’ homeAddress, workAddress ì»¬ëŸ¼

<br>

## ğŸš«Â ê°’ íƒ€ì…ê³¼ ë¶ˆë³€ ê°ì²´

ê°’ íƒ€ì… : ë³µì¡í•œ ê°ì²´ ì„¸ìƒ ì¡°ê¸ˆì´ë¼ë„ ë‹¨ìˆœí™”í•˜ë ¤ê³  ë§Œë“  ê°œë…, **ë‹¨ìˆœí•˜ê³  ì•ˆì „í•˜ê²Œ** ë‹¤ë£° ìˆ˜ ìˆì–´ì•¼ í•¨

<br>

### ê°’ íƒ€ì… ê³µìœ  ì°¸ì¡°

ì„ë² ë””ë“œ íƒ€ì… ê°™ì€ ê°’ íƒ€ì…ì„ ì—¬ëŸ¬ ì—”í‹°í‹°ì—ì„œ ê³µìœ í•˜ë©´ ìœ„í—˜ â†’ ë¶€ì‘ìš© ë°œìƒ

![Untitled](/img/jpa_basic/section9/value_type_share.png)

```java
Address address = new Address("city", "street", "10000");

Member member1 = new Member();
member1.setUsername("member1");
member1.setHomeAddress(address);
em.persist(member1);

Member member2 = new Member();
member2.setUsername("member2");
member2.setHomeAddress(address);
em.persist(member2);

member1.getHomeAddress().setCity("newCity"); // ë‘ ë²ˆì˜ update ì´ˆë˜
```


â‡’ ê°’ íƒ€ì… ë³µì‚¬í•´ì„œ ì‚¬ìš©

![Untitled](/img/jpa_basic/section9/value_type_copy.png)

```java
Address copyAddress = new Address(address.getCity(), address.getStreet(), address.getZipcode());
Member member2 = new Member();
member2.setUsername("member2");
member2.setHomeAddress(copyAddress);
em.persist(member2);
```

<br>

### ê°ì²´ íƒ€ì…ì˜ í•œê³„

í•­ìƒ ê°’ì„ ë³µì‚¬í•´ì„œ ì‚¬ìš©í•˜ë©´ ê³µìœ  ì°¸ì¡°ë¡œ ì¸í•´ ë°œìƒí•˜ëŠ” ë¶€ì‘ìš© í”¼í•  ìˆ˜ ìˆìŒ

ë¬¸ì œëŠ” ì„ë² ë””ë“œ íƒ€ì…ì²˜ëŸ¼ ì§ì ‘ ì •ì˜í•œ ê°’ íƒ€ì…ì€ ìë°”ì˜ ê¸°ë³¸ íƒ€ì…ì´ ì•„ë‹ˆë¼ **ê°ì²´ íƒ€ì…**

ê°ì²´ íƒ€ì…ì€ ì°¸ì¡° ê°’ì„ ì§ì ‘ ëŒ€ì… â†’ ë§‰ì„ ìˆ˜ ì—†ìŒ, ê°ì²´ì˜ ê³µìœ  ì°¸ì¡°ëŠ” í”¼í•  ìˆ˜ ì—†ìŒ

<br>

### ë¶ˆë³€ ê°ì²´

ê°ì²´ íƒ€ì… ìˆ˜ì •í•  ìˆ˜ ì—†ê²Œ ë¶€ì‘ìš© ì›ì²œ ì°¨ë‹¨ â†’ **ê°’ íƒ€ì…ì€ ë¶ˆë³€ ê°ì²´ë¡œ ì„¤ê³„** (ìƒì„± ì´í›„ ë³€ê²½ X)

- ìƒì„±ìë¡œë§Œ ê°’ ì„¤ì •í•˜ê³  ìˆ˜ì •ì ë§Œë“¤ì§€ ì•Šìœ¼ë©´ ë¨ ë˜ëŠ” private â†’ ex) Integer, String

**ê°’ì„ ë°”ê¾¸ê³  ì‹¶ì„ë•ŒëŠ” ì–´ë–»ê²Œ??**

ìƒˆë¡­ê²Œ ê°ì²´ ë§Œë“¤ê³  í• ë‹¹í•´ì•¼í•¨

```java
Address newAddress = new Address(address.getCity(), address.getStreet(), "11111");
member1.setHomeAddress(newAddress);
```

<br>

## âš–ï¸Â ê°’ íƒ€ì…ì˜ ë¹„êµ

ì¸ìŠ¤í„´ìŠ¤ê°€ ë‹¬ë¼ë„ ê·¸ ì•ˆì— ê°’ì´ ê°™ìœ¼ë©´ ê°™ì€ ê²ƒìœ¼ë¡œ ë´ì•¼ í•¨

```java
int a = 10;
int b = 10;
print(a==b); //true

Address address1 = new Address("city", "street", "10000");
Address address2 = new Address("city", "street", "10000");
System.out.println("address1 == address2 " + (address1==address2)); //false
```

ë™ì¼ì„± ë¹„êµ identity : ì°¸ì¡° ê°’ ë¹„êµ, `==`  

ë™ë“±ì„± ë¹„êµ equivalence : ê°’ ë¹„êµ, `equals()` 

â‡’ ê°’ íƒ€ì…ì€ ë™ë“±ì„± ë¹„êµ! `equals` ì¬ì •ì˜ (â†’ `hashCode` ë„ ì¬ì •ì˜ í•„ìš” )

<br>

## ğŸ—Â ê°’ íƒ€ì… ì»¬ë ‰ì…˜

![Untitled](/img/jpa_basic/section9/value_type_collection.png)

ê°’ íƒ€ì…ì„ ì»¬ë ‰ì…˜ì— ë‹´ì•„ì„œ ì‚¬ìš©

DBì—ëŠ” ì»¬ë ‰ì…˜ ê°œë…ì´ ì—†ê¸° ë•Œë¬¸ì— ***ë³„ë„ì˜ í…Œì´ë¸” ìƒì„±***

```java
public class Member { 
		...		
		@ElementCollection
    @CollectionTable(name = "FAVORITE_FOOD", joinColumns =
    @JoinColumn(name = "MEMBER_ID"))
    @Column(name = "FOOD_NAME")
    private Set<String> favoriteFoods = new HashSet<>();

    @ElementCollection
    @CollectionTable(name = "ADDRESS", joinColumns =
    @JoinColumn(name = "MEMBER_ID"))
    private List<Address> addressHistory = new ArrayList<>();
		...
}
```

`@ElementCollection` : ê°’ íƒ€ì… ì»¬ë ‰ì…˜ìœ¼ë¡œ ì‚¬ìš©í•  ë•Œ í•„ìš”

`@Collectiontable` : table ì´ë¦„, join column ë“± ì§€ì •

```sql
Hibernate: 
    
    create table FAVORITE_FOOD (
       MEMBER_ID bigint not null,
        FOOD_NAME varchar(255)
    )
Hibernate: 
    
    create table Member (
       MEMBER_ID bigint not null,
        city varchar(255),
        street varchar(255),
        zipcode varchar(255),
        USERNAME varchar(255),
        endDate timestamp,
        startDate timestamp,
        primary key (MEMBER_ID)
    )
Hibernate: 
    
    create table ADDRESS (
       MEMBER_ID bigint not null,
        city varchar(255),
        street varchar(255),
        zipcode varchar(255)
		)
```

<br>

### ê°’ íƒ€ì… ì»¬ë ‰ì…˜ ì‚¬ìš©

- ì €ì¥
    
    ```java
    Member member1 = new Member();
    member1.setUsername("member1");
    member1.setHomeAddress(new Address("homeCity", "street", "10000"));
    
    member1.getFavoriteFoods().add("ì¹˜í‚¨");
    member1.getFavoriteFoods().add("ì¡±ë°œ");
    member1.getFavoriteFoods().add("í”¼ì");
    
    member1.getAddressHistory().add(new Address("old1", "street", "10000"));
    member1.getAddressHistory().add(new Address("old2", "street", "10000"));
    
    em.persist(member1);
    ```
    
    ë°œìƒí•˜ëŠ” ì¿¼ë¦¬ë¬¸
    
    - insert member
    - insert address * 2 (â† addressHistory )
    - insert favoriteFood * 3
    - insert address

- ì¡°íšŒ â†’ ì§€ì—° ë¡œë”© ì „ëµ
- ìˆ˜ì •
    
    ```java
    //homeCity -> newCity
    //findMember.getHomeAddress().setCity() -> ì´ë ‡ê²Œ í•˜ë©´ ì•ˆ ë¨!
    Address a = findMember.getHomeAddress();
    findMember.setHomeAddress(new Address("newCity", a.getStreet(), a.getZipcode()));
    
    //ì¹˜í‚¨ -> í•œì‹
    findMember.getFavoriteFoods().remove("ì¹˜í‚¨");
    findMember.getFavoriteFoods().add("í•œì‹");
    
    //equals ì‚¬ìš©í•´ì„œ ì œê±°
    findMember.getAddressHistory().remove(new Address("old1", "street", "10000"));
    findMember.getAddressHistory().add(new Address("newCity1", "street", "10000"));
    ```
    
    ì»¬ë ‰ì…˜ ê°’ë§Œ ë³€ê²½í•´ë„ ì•Œì•„ì„œ delete, insert ì¿¼ë¦¬ ë°œìƒ â†’ ë§ˆì¹˜ ì˜ì†ì„± ì „ì´
    
    `AddressHistory` ìˆ˜ì •í•  ë•ŒëŠ” ë©¤ë²„ì™€ ê´€ë ¨ëœ ëª¨ë“  ê°’ì„ ë‹¤ delete í•œ í›„ ë‹¤ì‹œ ë‹¤ insert
    

> **ê°’ íƒ€ì… ì»¬ë ‰ì…˜ì€ ì˜ì†ì„± ì „ì´(cascade) + ê³ ì•„ ê°ì²´ ì œê±° ê¸°ëŠ¥ í•„ìˆ˜ë¡œ ê°€ì§**
> 

<br>

### ê°’ íƒ€ì… ì»¬ë ‰ì…˜ ì œì•½ì‚¬í•­

ì—”í‹°í‹°ì™€ ë‹¤ë¥´ê²Œ ì‹ë³„ì ê°œë…ì´ ì—†ìŒ â†’ ë³€ê²½í•˜ë©´ ì¶”ì  ì–´ë ¤ì›€

ë”°ë¼ì„œ ê°’ íƒ€ì… ì»¬ë ‰ì…˜ ë³€ê²½ ì‚¬í•­ ë°œìƒí•˜ë©´ ì£¼ì¸ ì—”í‹°í‹°ì™€ ì—°ê´€ëœ ëª¨ë“  ë°ì´í„° ì‚­ì œ, ê°’ íƒ€ì… ì»¬ë ‰ì…˜ì— ìˆëŠ” í˜„ì¬ ê°’ ëª¨ë‘ ì €ì¥

ê°’ íƒ€ì… ì»¬ë ‰ì…˜ ë§¤í•‘ í…Œì´ë¸”ì€ ëª¨ë“  ì»¬ëŸ¼ ë¬¶ì–´ì„œ ê¸°ë³¸í‚¤ êµ¬ì„±(null X, ì¤‘ë³µ X)

> *ì‹¤ë¬´ì—ì„œëŠ” ê°’ íƒ€ì… ì»¬ë ‰ì…˜ ëŒ€ì‹  **ì¼ëŒ€ë‹¤ ê´€ê³„** ê³ ë ¤*
> 
> 
> ì˜ì†ì„± ì „ì´ + ê³ ì•„ ê°ì²´ ì œê±° ì‚¬ìš©í•´ì„œ ê°’ íƒ€ì… ì»¬ë ‰ì…˜ì²˜ëŸ¼ ì‚¬ìš©
> 

<br>

ê°’ íƒ€ì… ì»¬ë ‰ì…˜ **ì–¸ì œ ì‚¬ìš©?**

select box (multi check) ì´ëŸ°ì‹ìœ¼ë¡œ ë‹¨ìˆœ ë¬¸ìì—´ê³¼ ê°™ì´ ì¶”ì í•  í•„ìš”ê°€ ì—†ê³  update í•  í•„ìš” ì—†ì„ ë•Œ 

<br>

## ğŸŒ´Â ì‹¤ì „ ì˜ˆì œ 6 - ê°’ íƒ€ì… ë§¤í•‘

ê°’ íƒ€ì…ìœ¼ë¡œ ì“¸ë§Œí•œ ê²ƒ : `Address` 

```java
@Embeddable
public class Address {
		private String city;
    private String street;
    private String zipcode;

		...

		@Override
    public boolean equals(Object o) {
        if (this == o) {
            return true;
        }
        if (o == null || getClass() != o.getClass()) {
            return false;
        }
        Address address = (Address) o;
        return Objects.equals(getCity(), address.getCity()) && Objects.equals(getStreet(), address.getStreet()) && Objects.equals(getZipcode(), address.getZipcode());
    }

    @Override
    public int hashCode() {
        return Objects.hash(getCity(), getStreet(), getZipcode());
    }
}
```

> `equals` ë§Œë“¤ ë•Œ `getter` ì´ìš©í•´ì•¼ í•¨ ì•„ë‹ˆë©´ proxyì¼ ë•Œ ì ‘ê·¼ ì•ˆë¨
>